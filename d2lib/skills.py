from enum import IntEnum

from d2lib.classes import CharacterClass

SKILLS_TREE_OFFSETS = {
    CharacterClass.AMAZON: 0,
    CharacterClass.SORCERESS: 3,
    CharacterClass.NECROMANCER: 6,
    CharacterClass.PALADIN: 9,
    CharacterClass.BARBARIAN: 12,
    CharacterClass.DRUID: 15,
    CharacterClass.ASSASSIN: 18,
}

SKILLS_TREE_NAMES = {
    0: 'Bow and Crossbow Skills',
    1: 'Passive and Magic Skills',
    2: 'Javelin and Spear Skills',
    3: 'Fire Spells',
    4: 'Lightning Spells',
    5: 'Cold Spells',
    6: 'Curses',
    7: 'Poison and Bone Skills',
    8: 'Summoning Skills',
    9: 'Combat Skills',
    10: 'Offensive Auras',
    11: 'Defensive Auras',
    12: 'Combat Skills',
    13: 'Masteries',
    14: 'Warcries',
    15: 'Summoning Skills',
    16: 'Shape Shifting Skills',
    17: 'Elemental Skills',
    18: 'Traps',
    19: 'Shadow Disciplines',
    20: 'Martial Arts',
}

SKILL_OFFSETS = {
    CharacterClass.AMAZON: 6,
    CharacterClass.SORCERESS: 36,
    CharacterClass.NECROMANCER: 66,
    CharacterClass.PALADIN: 96,
    CharacterClass.BARBARIAN: 126,
    CharacterClass.DRUID: 221,
    CharacterClass.ASSASSIN: 251,
}


class Skill(IntEnum):  # NOQA
    ATTACK = 0
    KICK = 1
    THROW_ITEM = 2
    UNSUMMON = 3
    LEFT_HAND_THROW = 4
    LEFT_HAND_SWING = 5
    MAGIC_ARROW = 6
    FIRE_ARROW = 7
    INNER_SIGHT = 8
    CRITICAL_STRIKE = 9
    JAB = 10
    COLD_ARROW = 11
    MULTIPLE_SHOT = 12
    DODGE = 13
    POWER_STRIKE = 14
    POISON_JAVELIN = 15
    EXPLODING_ARROW = 16
    SLOW_MISSILES = 17
    AVOID = 18
    IMPALE = 19
    LIGHTNING_BOLT = 20
    ICE_ARROW = 21
    GUIDED_ARROW = 22
    PENETRATE = 23
    CHARGED_STRIKE = 24
    PLAGUE_JAVELIN = 25
    STRAFE = 26
    IMMOLATION_ARROW = 27
    DOPPLEZON = 28
    EVADE = 29
    FEND = 30
    FREEZING_ARROW = 31
    VALKYRIE = 32
    PIERCE = 33
    LIGHTNING_STRIKE = 34
    LIGHTNING_FURY = 35
    FIRE_BOLT = 36
    WARMTH = 37
    CHARGED_BOLT = 38
    ICE_BOLT = 39
    FROZEN_ARMOR = 40
    INFERNO = 41
    STATIC_FIELD = 42
    TELEKINESIS = 43
    FROST_NOVA = 44
    ICE_BLAST = 45
    BLAZE = 46
    FIRE_BALL = 47
    NOVA = 48
    LIGHTNING = 49
    SHIVER_ARMOR = 50
    FIRE_WALL = 51
    ENCHANT = 52
    CHAIN_LIGHTNING = 53
    TELEPORT = 54
    GLACIAL_SPIKE = 55
    METEOR = 56
    THUNDER_STORM = 57
    ENERGY_SHIELD = 58
    BLIZZARD = 59
    CHILLING_ARMOR = 60
    FIRE_MASTERY = 61
    HYDRA = 62
    LIGHTNING_MASTERY = 63
    FROZEN_ORB = 64
    COLD_MASTERY = 65
    AMPLIFY_DAMAGE = 66
    TEETH = 67
    BONE_ARMOR = 68
    SKELETON_MASTERY = 69
    RAISE_SKELETON = 70
    DIM_VISION = 71
    WEAKEN = 72
    POISON_DAGGER = 73
    CORPSE_EXPLOSION = 74
    CLAY_GOLEM = 75
    IRON_MAIDEN = 76
    TERROR = 77
    BONE_WALL = 78
    GOLEM_MASTERY = 79
    RAISE_SKELETAL_MAGE = 80
    CONFUSE = 81
    LIFE_TAP = 82
    POISON_EXPLOSION = 83
    BONE_SPEAR = 84
    BLOOD_GOLEM = 85
    ATTRACT = 86
    DECREPIFY = 87
    BONE_PRISON = 88
    SUMMON_RESIST = 89
    IRON_GOLEM = 90
    LOWER_RESIST = 91
    POISON_NOVA = 92
    BONE_SPIRIT = 93
    FIRE_GOLEM = 94
    REVIVE = 95
    SACRIFICE = 96
    SMITE = 97
    MIGHT = 98
    PRAYER = 99
    RESIST_FIRE = 100
    HOLY_BOLT = 101
    HOLY_FIRE = 102
    THORNS = 103
    DEFIANCE = 104
    RESIST_COLD = 105
    ZEAL = 106
    CHARGE = 107
    BLESSED_AIM = 108
    CLEANSING = 109
    RESIST_LIGHTNING = 110
    VENGEANCE = 111
    BLESSED_HAMMER = 112
    CONCENTRATION = 113
    HOLY_FREEZE = 114
    VIGOR = 115
    CONVERSION = 116
    HOLY_SHIELD = 117
    HOLY_SHOCK = 118
    SANCTUARY = 119
    MEDITATION = 120
    FIST_OF_THE_HEAVENS = 121
    FANATICISM = 122
    CONVICTION = 123
    REDEMPTION = 124
    SALVATION = 125
    BASH = 126
    SWORD_MASTERY = 127
    AXE_MASTERY = 128
    MACE_MASTERY = 129
    HOWL = 130
    FIND_POTION = 131
    LEAP = 132
    DOUBLE_SWING = 133
    POLE_ARM_MASTERY = 134
    THROWING_MASTERY = 135
    SPEAR_MASTERY = 136
    TAUNT = 137
    SHOUT = 138
    STUN = 139
    DOUBLE_THROW = 140
    INCREASED_STAMINA = 141
    FIND_ITEM = 142
    LEAP_ATTACK = 143
    CONCENTRATE = 144
    IRON_SKIN = 145
    BATTLE_CRY = 146
    FRENZY = 147
    INCREASED_SPEED = 148
    BATTLE_ORDERS = 149
    GRIM_WARD = 150
    WHIRLWIND = 151
    BERSERK = 152
    NATURAL_RESISTANCE = 153
    WAR_CRY = 154
    BATTLE_COMMAND = 155
    FIRE_HIT = 156
    UNHOLY_BOLT = 157
    SKELETON_RAISE = 158
    MAGGOT_EGG = 159
    SHAMAN_FIRE = 160
    MAGOTTUP = 161
    MAGOTTDOWN = 162
    MAGOTTLAY = 163
    ANDRIAL_SPRAY = 164
    JUMP = 165
    SWARM_MOVE = 166
    NEST = 167
    QUICK_STRIKE = 168
    VAMPIRE_FIREBALL = 169
    VAMPIRE_FIREWALL = 170
    VAMPIRE_METEOR = 171
    GARGOYLE_TRAP = 172
    SPIDER_LAY = 173
    VAMPIRE_HEAL = 174
    VAMPIRE_RAISE = 175
    SUBMERGE = 176
    FETISH_AURA = 177
    FETISH_INFERNO = 178
    ZAKARUM_HEAL = 179
    EMERGE = 180
    RESURRECT = 181
    BESTOW = 182
    MISSILE_SKILL1 = 183
    MON_TELEPORT = 184
    PRIME_LIGHTNING = 185
    PRIME_BOLT = 186
    PRIME_BLAZE = 187
    PRIME_FIREWALL = 188
    PRIME_SPIKE = 189
    PRIME_ICE_NOVA = 190
    PRIME_POISON_BALL = 191
    PRIME_POISON_NOVA = 192
    DIABLIGHT = 193
    DIABCOLD = 194
    DIABFIRE = 195
    FINGERMAGESPIDER = 196
    DIABWALL = 197
    DIABRUN = 198
    DIABPRISON = 199
    POISON_BALL_TRAP = 200
    ANDY_POISON_BOLT = 201
    HIREABLE_MISSILE = 202
    DESERT_TURRET = 203
    ARCANE_TOWER = 204
    MONBLIZZARD = 205
    MOSQUITO = 206
    CURSED_BALL_TRAP_RIGHT = 207
    CURSED_BALL_TRAP_LEFT = 208
    MONFROZENARMOR = 209
    MONBONEARMOR = 210
    MONBONESPIRIT = 211
    MONCURSECAST = 212
    HELLMETEOR = 213
    REGURGITATOREAT = 214
    MONFRENZY = 215
    QUEENDEATH = 216
    SCROLL_OF_IDENTIFY = 217
    BOOK_OF_IDENTIFY = 218
    SCROLL_OF_TOWNPORTAL = 219
    BOOK_OF_TOWNPORTAL = 220
    RAVEN = 221
    POISON_CREEPER = 222
    WEARWOLF = 223
    SHAPE_SHIFTING = 224
    FIRESTORM = 225
    OAK_SAGE = 226
    SUMMON_SPIRIT_WOLF = 227
    WEARBEAR = 228
    MOLTEN_BOULDER = 229
    ARCTIC_BLAST = 230
    CYCLE_OF_LIFE = 231
    FERAL_RAGE = 232
    MAUL = 233
    ERUPTION = 234
    CYCLONE_ARMOR = 235
    HEART_OF_WOLVERINE = 236
    SUMMON_FENRIS = 237
    RABIES = 238
    FIRE_CLAWS = 239
    TWISTER = 240
    VINES = 241
    HUNGER = 242
    SHOCK_WAVE = 243
    VOLCANO = 244
    TORNADO = 245
    SPIRIT_OF_BARBS = 246
    SUMMON_GRIZZLY = 247
    FURY = 248
    ARMAGEDDON = 249
    HURRICANE = 250
    FIRE_BLAST = 251
    CLAW_MASTERY = 252
    PSYCHIC_HAMMER = 253
    TIGER_STRIKE = 254
    DRAGON_TALON = 255
    SHOCK_FIELD = 256
    BLADE_SENTINEL = 257
    QUICKNESS = 258
    FISTS_OF_FIRE = 259
    DRAGON_CLAW = 260
    CHARGED_BOLT_SENTRY = 261
    WAKE_OF_FIRE_SENTRY = 262
    WEAPON_BLOCK = 263
    CLOAK_OF_SHADOWS = 264
    COBRA_STRIKE = 265
    BLADE_FURY = 266
    FADE = 267
    SHADOW_WARRIOR = 268
    CLAWS_OF_THUNDER = 269
    DRAGON_TAIL = 270
    LIGHTNING_SENTRY = 271
    INFERNO_SENTRY = 272
    MIND_BLAST = 273
    BLADES_OF_ICE = 274
    DRAGON_FLIGHT = 275
    DEATH_SENTRY = 276
    BLADE_SHIELD = 277
    VENOM = 278
    SHADOW_MASTER = 279
    ROYAL_STRIKE = 280
    WAKE_OF_DESTRUCTION_SENTRY = 281
    IMP_INFERNO = 282
    IMP_FIREBALL = 283
    BAAL_TAUNT = 284
    BAAL_CORPSE_EXPLODE = 285
    BAAL_MONSTER_SPAWN = 286
    CATAPULT_CHARGED_BALL = 287
    CATAPULT_SPIKE_BALL = 288
    SUCK_BLOOD = 289
    CRY_HELP = 290
    HEALING_VORTEX = 291
    TELEPORT_2 = 292
    SELF_RESURRECT = 293
    VINE_ATTACK = 294
    OVERSEER_WHIP = 295
    BARBS_AURA = 296
    WOLVERINE_AURA = 297
    OAK_SAGE_AURA = 298
    IMP_FIRE_MISSILE = 299
    IMPREGNATE = 300
    SIEGE_BEAST_STOMP = 301
    MINIONSPAWNER = 302
    CATAPULTBLIZZARD = 303
    CATAPULTPLAGUE = 304
    CATAPULTMETEOR = 305
    BOLTSENTRY = 306
    CORPSECYCLER = 307
    DEATHMAUL = 308
    DEFENSE_CURSE = 309
    BLOOD_MANA = 310
    MON_INFERNO_SENTRY = 311
    MON_DEATH_SENTRY = 312
    SENTRY_LIGHTNING = 313
    FENRIS_RAGE = 314
    BAAL_TENTACLE = 315
    BAAL_NOVA = 316
    BAAL_INFERNO = 317
    BAAL_COLD_MISSILES = 318
    MEGA_DEMON_INFERNO = 319
    EVIL_HUT_SPAWNER = 320
    COUNTESS_FIREWALL = 321
    IMPBOLT = 322
    HORROR_ARCTIC_BLAST = 323
    DEATH_SENTRY_LTNG = 324
    VINECYCLER = 325
    BEARSMITE = 326
    RESURRECT2 = 327
    BLOODLORD_FRENZY = 328
    BAAL_TELEPORT = 329
    IMP_TELEPORT = 330
    BAAL_CLONE_TELEPORT = 331
    ZAKARUM_LIGHTNING = 332
    VAMPIRE_MISSILE = 333
    MEPHISTO_MISSILE = 334
    DOOM_KNIGHT_MISSILE = 335
    ROGUE_MISSILE = 336
    HYDRA_MISSILE = 337
    NECRO_MAGE_MISSILE = 338
    MONBOW = 339
    MONFIREARROW = 340
    MONCOLDARROW = 341
    MONEXPLODINGARROW = 342
    MONFREEZINGARROW = 343
    MONPOWERSTRIKE = 344
    SUCCUBUSBOLT = 345
    MEPHFROSTNOVA = 346
    MONICESPEAR = 347
    SHAMAN_ICE = 348
    DIABLOGEDDON = 349
    DELERIUM_CHANGE = 350
    NIHLATHAK_CORPSE_EXPLOSION = 351
    SERPENT_CHARGE = 352
    TRAP_NOVA = 353
    UNHOLY_BOLTEX = 354
    SHAMAN_FIREEX = 355
    IMP_FIRE_MISSILE_EX = 356

    def __str__(self):
        return self.name.replace('_', ' ').title()
